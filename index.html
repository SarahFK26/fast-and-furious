<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Fast & Furious ‚Äì Manual Track Switch</title>

<style>
body {
    margin: 0;
    background: black;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
}
canvas {
    border: 3px solid white;
    display: block;
    margin: auto;
    background: black;
}
button {
    padding: 10px 20px;
    font-size: 16px;
    margin: 10px;
}
</style>
</head>
<body>

<h1>üèéÔ∏è Fast & Furious ‚Äì Manual Track Switch</h1>
<div>
    <strong id="track">Bane: Los Angeles</strong> |
    Poeng: <span id="score">0</span>
</div>

<button onclick="startGame()">‚ñ∂ Start</button>
<p>‚¨Ö ‚û° = Styr &nbsp; | &nbsp; T = Bytt bane</p>

<canvas id="game" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* üåç BANER */
const tracks = [
    { name:"Los Angeles", road:"#333", edge:"#777", speed:5 },
    { name:"Miami", road:"#00bcd4", edge:"#2ed573", speed:5 },
    { name:"Tokyo", road:"#0b0014", edge:"#ff00ff", speed:7 },
    { name:"London", road:"#2f3640", edge:"#718093", speed:6 },
    { name:"Norwegian Fjords", road:"#1e3799", edge:"#81ecec", speed:6 }
];

let trackIndex = 0;
let track = tracks[0];

/* üöó SPILLER */
let player = {
    x: 200,
    y: 480,
    width: 35,
    height: 70,
    velocity: 0
};

let cars = [];
let score = 0;
let running = false;

/* üéÆ INPUT ‚Äì KUN PILTASTER */
let leftPressed = false;
let rightPressed = false;

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") leftPressed = true;
    if (e.key === "ArrowRight") rightPressed = true;

    if (e.key.toLowerCase() === "t") {
        switchTrack(); // üîÅ MANUELL BANEBYTTE
    }
});

document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") leftPressed = false;
    if (e.key === "ArrowRight") rightPressed = false;
});

/* üõ£Ô∏è VEI MED PERSPEKTIV */
function drawRoad() {
    ctx.fillStyle = track.road;
    ctx.beginPath();
    ctx.moveTo(80, 600);
    ctx.lineTo(160, 0);
    ctx.lineTo(240, 0);
    ctx.lineTo(320, 600);
    ctx.closePath();
    ctx.fill();

    ctx.strokeStyle = track.edge;
    ctx.lineWidth = 5;
    ctx.beginPath();
    ctx.moveTo(80, 600);
    ctx.lineTo(160, 0);
    ctx.moveTo(320, 600);
    ctx.lineTo(240, 0);
    ctx.stroke();

    ctx.setLineDash([20,20]);
    ctx.strokeStyle = "#fff";
    ctx.beginPath();
    ctx.moveTo(200, 600);
    ctx.lineTo(200, 0);
    ctx.stroke();
    ctx.setLineDash([]);
}

/* üöì ANDRE BILER */
function spawnCar() {
    cars.push({
        x: 160 + Math.random() * 80,
        y: -100,
        width: 35,
        height: 70,
        speed: track.speed + Math.random() * 2,
        color: ["#fff","#f1c40f","#e74c3c","#2ecc71"]
            [Math.floor(Math.random()*4)]
    });
}

function collision(a, b) {
    return a.x < b.x + b.width &&
           a.x + a.width > b.x &&
           a.y < b.y + b.height &&
           a.y + a.height > b.y;
}

/* üîÅ MANUELL BANEBYTTE */
function switchTrack() {
    trackIndex = (trackIndex + 1) % tracks.length;
    track = tracks[trackIndex];
    document.getElementById("track").innerText = "Bane: " + track.name;
}

/* ‚ñ∂ START */
function startGame() {
    running = true;
    cars = [];
    score = 0;
    trackIndex = 0;
    track = tracks[0];
    document.getElementById("track").innerText = "Bane: " + track.name;
    update();
}

/* üîÑ GAME LOOP */
function update() {
    if (!running) return;

    ctx.clearRect(0,0,400,600);
    drawRoad();

    // Myk styring
    if (leftPressed) player.velocity -= 0.4;
    if (rightPressed) player.velocity += 0.4;
    player.velocity *= 0.9;

    player.x += player.velocity;
    player.x = Math.max(110, Math.min(255, player.x));

    // Spiller
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y, player.width, player.height);

    cars.forEach(car => {
        car.y += car.speed;
        ctx.fillStyle = car.color;
        ctx.fillRect(car.x, car.y, car.width, car.height);

        if (collision(player, car)) {
            running = false;
            alert("üí• KR√ÜSJ!\nPoeng: " + score);
        }
    });

    cars = cars.filter(c => c.y < 700);
    if (Math.random() < 0.03) spawnCar();

    score++;
    document.getElementById("score").innerText = score;

    requestAnimationFrame(update);
}
</script>

</body>
</html>
